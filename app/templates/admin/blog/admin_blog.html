{% extends 'admin/admin.html' %}

{% block adminmain %}
<div class="container" style="padding-top: 50px;">
  <div class="row justify-content-between" style="margin: 0 5px 10px 5px">
    {% if g.admin_search_form %}
    <form class="mb-3 form-inline" method="get" action="{{ url_for('admin.search_blog') }}">
      {{ g.admin_search_form.q(class_='form-control mr-sm-2', size=60, placeholder=g.search_form.q.label.text) }}
      <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
    </form>
    {% endif %}
    <a class="text-info" href="{{ url_for('admin.new_blog') }}">
      <button type="button" class="btn btn-info">New Post</button>
    </a>
  </div>
  <table class="table table-striped table-bordered table-active">
    <thead class="thead-dark">
    <tr>
      <th scope="col">#</th>
      <th scope="col">Title</th>
      <th scope="col">Pub Date</th>
      <th scope="col">Tags</th>
      <th scope="col">PV</th>
      <th scope="col">Edit</th>
      <th scope="col">Del</th>
    </tr>
    </thead>
    <tbody>
    {% for post in posts %}
    <tr>
      <th scope="row">{{ post.id }}</th>
      <td>{{ post.title }}</td>
      <td>{{ post.pub_date }}</td>
      <td>
        <div class="btn-group-sm" role="group">
          {% for tag in post.tags %}
          <button type="button" class="btn btn-warning" style="padding: 0 5px 0 5px">{{ tag.name }}</button>
          {% endfor %}
        </div>
      </td>
      <td>{{ post.pv }}</td>
      <td><a href="{{ url_for('admin.edit_blog', id=post.id) }}"><i class="text-success" width="28" height="28" data-feather="edit"></i></a></td>
      <td>
        <button type="button" class="btn btn-link" style="padding:0" data-toggle="modal" data-target="#deletePostModal{{ post.id }}">
          <i class="text-danger" width="28" height="28" data-feather="x-circle"></i>
        </button>
      </td>
    </tr>
    <!-- Modal -->
    <div class="modal fade" id="deletePostModal{{ post.id }}" tabindex="-1" role="dialog" aria-labelledby="deletePostModalLabel{{ post.id }}" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="deletePostModalLabel{{ post.id }}">删除文章</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            确认删除文章《<span class="text-info">{{ post.title }}</span>》 ?
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
            <a href="{{ url_for('admin.del_blog', id=post.id) }}">
              <button type="button" class="btn btn-danger">确认删除</button>
            </a>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
    </tbody>
  </table>

  <nav aria-label="Page navigation example">
    <ul class="pagination justify-content-center">
      {% if prev_url %}
      <li class="page-item">
        <a class="page-link" href="{{ prev_url }}">上一页</a>
      </li>
      {% else %}
      <li class="page-item disabled">
        <a class="page-link" href="#">上一页</a>
      </li>
      {% endif %}
      {% if next_url %}
      <li class="page-item">
        <a class="page-link" href="{{ next_url }}">下一页</a>
      </li>
      {% else %}
      <li class="page-item disabled">
        <a class="page-link" href="#">下一页</a>
      </li>
      {% endif %}
    </ul>
  </nav>

</div>
{% endblock %}